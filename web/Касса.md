# Врайтап на задание Касса из веба


## Шаг 1

Открыв файл `routes.py` я заметил уязвимую библиотеку питон
`import pickle`
Далее я пошел смотреть где она используется, увидел что она используется в `/check-ticket`, а именно при аплоаде файла если указать у него расширение .pkl можно было залить произвольный python код который будет исполняться.

## Шаг 2

Я скачал рандомный билет, и пошел загружать его в `/check-ticket`. Перехватив пост запрос через бурп увидели как загружается файл

```
------WebKitFormBoundaryw5kbnAYvCgCcl7zK
Content-Disposition: form-data; name="ticket_file"; filename="check.pkl"
Content-Type: application/octet-stream

����models��    TicketDTO���)��}�(�name�Ticket 1��user�marcusov��
time_stamp�datetime�datetime���C
 ▒���R��sign��(9aefe5d37596de1f036d58ed85f00baa59d7abdc�ub.
------WebKitFormBoundaryw5kbnAYvCgCcl7zK-
```
Далее я погуглил эксплоиты на pickle, нашел такой сплоит

```

```
Далее я заменил прошлое содержимое файла .pkl на это, и неожиданно увидел ошибку, чутка подумал и понял, может мне показывает что тут ошибка, а по факту код выполняется на сервере.
Следующее что я сделал, это подумал что флаг находится в `env`. И написал команду которая будет из `env` флаг записывать в `static/flag.txt`
